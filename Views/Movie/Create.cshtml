@model Ticket.Models.Movie
@{
    ViewData["Title"] = "Créer un nouveau film";
}

<h4>Créer un nouveau film</h4>

<form asp-action="Create" method="post" enctype="multipart/form-data">
    @Html.AntiForgeryToken()
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="row">
        <!-- Colonne gauche : titre, dates, description, image -->
        <div class="col-md-6">
            <input asp-for="Title" class="form-control mb-2" placeholder="Titre du film" />
            <input asp-for="StartDate" type="date" class="form-control mb-2" />
            <input asp-for="EndDate" type="date" class="form-control mb-2" />
            <textarea asp-for="Description" class="form-control mb-2" placeholder="Description"></textarea>

            <input asp-for="ImageFile" type="file" class="form-control mb-2" accept="image/*" />
            <img id="ImagePreview" class="img-fluid mb-2" style="max-height:300px;" />
        </div>

        <!-- Colonne droite : producteurs et acteurs -->
        <div class="col-md-6">
            <label>Producteur existant</label>
            <select asp-for="ProducerId" asp-items="(SelectList)ViewBag.Producers" class="form-control mb-2"></select>

            <label>Ou créer un nouveau producteur</label>
            <input asp-for="NewProducerName" class="form-control mb-2" placeholder="Nom du producteur" />

            <label>Acteurs existants</label>
            <select asp-for="ActorIds" asp-items="(MultiSelectList)ViewBag.Actors" class="form-control mb-2" multiple></select>

            <label>Ou ajouter de nouveaux acteurs (séparés par virgule)</label>
            <input asp-for="NewActorsNames" class="form-control mb-2" placeholder="Ex: John Doe, Jane Smith" />
        </div>
    </div>

    <button type="submit" class="btn btn-success mt-2">Créer</button>
    <a asp-action="Index" class="btn btn-secondary mt-2">Retour</a>
</form>

@section Scripts {
    <script>
        // Preview image locale
        document.getElementById("ImageFile").addEventListener("change", function (e) {
            const [file] = e.target.files;
            if (file) document.getElementById("ImagePreview").src = URL.createObjectURL(file);
        });
    </script>
}
